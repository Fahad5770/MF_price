package com.pbc.util;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.Reader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLEncoder;
import java.util.LinkedHashMap;
import java.util.Map;

public class GoogleImageChartsWrapper {

	public static void getCashEmailChart() throws Exception {
        URL url = new URL("https://chart.googleapis.com/chart");
        Map<String,Object> params = new LinkedHashMap<>();
        params.put("cht", "lc");
        params.put("chd", "t:17,18,48,48,56,68,77,94,108,109,111,125,133,146,158,162,169,174,187,195,211,225,229,236,245,264,292,305,323,370,397,419,463,475,477,484,485,493,498,525,542,568,610,650,671,678,718,755,806,833,840,849,861,899,921,944,973,991,1029,1029,1036,1111,1126,1137,1147,1162,1185,1192,1212,1245,1262,1279,1297,1317,1326,1371,1392,1417,1439,1448,1475,1491,1532,1585,1641,1679,1726,1764,1787,1862,1991,2034,2045,2077,2101,2110,2143,2170,2193,2216,2233,2261,2278,2333,2420,2505,2531,2555,2585,2608,2648,2717,2752,2783,2832,2891,2917,2994,3060,3136,3255,3257,3280,3290,3316,3359,3399,3448,3496,3528,3560,3604,3689,3746,3845,3892,3909,3918,3955,3978,4000,4049,4115,4142,4164,4209,4241,4291,4341,4395,4463,4530,4550,4569,4589,4615,4651,4672,4700,4744,4786,4835,4887,4899,4941,5000,5047,5087,5128,5140,5150,5181,5210,5282,5360,5418,5455,5501,5555,5592,5688,5821,5841,5869,5894,5915,5941,5979,6048,6105,6174,6240,6283,6328,6392,6475,6512,6552,6581,6581,6583,6589,6607,6650,6708,6733,6773,6790,6838,6914,6991,7049,7164,7170,7175,7180,7189,7218,7255,7306,7346,7368,7399,7431,7466,7533,7556,7589,7621,7652,7690,7713,7759,7780,7813,7826,7871,7901,7949,7988,8007,8046,8072,8151,8167,8173,8182,8203,8213,8224,8247,8272,8301|0,2,3,13,23,46,49,50,57,69,73,80,83,88,89,94,96,102,107,110,116,117,123,128,142,160,169,180,195,218,240,253,260,266,286,288,295,304,321,336,357,374,387,404,432,494,505,510,529,537,545,562,588,618,647,681,707,761,798,891,897,904,914,926,939,958,998,1034,1101,1151,1191,1205,1209,1257,1291,1325,1349,1381,1412,1440,1506,1532,1551,1606,1633,1677,1700,1781,1823,1867,1946,1962,1973,1984,2022,2050,2087,2119,2169,2204,2228,2296,2326,2381,2411,2431,2468,2499,2541,2573,2618,2658,2686,2707,2728,2782,2834,2895,2936,2995,3043,3055,3071,3103,3131,3151,3180,3204,3242,3294,3335,3391,3424,3440,3474,3521,3558,3598,3648,3691,3728,3772,3794,3831,3889,3937,3967,4000,4037,4077,4134,4206,4216,4222,4227,4240,4256,4299,4324,4376,4427,4469,4509,4535,4579,4625,4683,4720,4730,4762,4795,4832,4880,4926,4962,4984,5016,5045,5100,5166,5234,5315,5322,5368,5417,5507,5549,5549,5549,5559,5575,5594,5644,5685,5704,5744,5789,5806,5817,5837,5853,5865,5893,5918,5950,5960,5988,6005,6027,6080,6122,6160,6207,6213,6221,6231,6244,6265,6277,6288,6308,6330,6356,6373,6392,6417,6424,6450,6477,6507,6531,6547,6563,6578,6602,6620,6632,6644,6655,6681,6707,6758,6817,6901,6913,6915,6922,6932,6955,6982,7008,7038,7082");
        params.put("chds", "a");
        params.put("chs", "595x250");
        params.put("chl", "Jan%201|Today");
        params.put("chxt", "y,r");
        params.put("chco", "bda609,0963bd,f0516c");
        params.put("chdl", "2015|2016");
        params.put("chdlp", "b");
        params.put("chtt", "(millions)");
        
        StringBuilder postData = new StringBuilder();
        for (Map.Entry<String,Object> param : params.entrySet()) {
            if (postData.length() != 0) postData.append('&');
            postData.append(URLEncoder.encode(param.getKey(), "UTF-8"));
            postData.append('=');
            postData.append(URLEncoder.encode(String.valueOf(param.getValue()), "UTF-8"));
        }
        byte[] postDataBytes = postData.toString().getBytes("UTF-8");

        HttpURLConnection conn = (HttpURLConnection)url.openConnection();
        conn.setRequestMethod("POST");
        conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
        conn.setRequestProperty("Content-Length", String.valueOf(postDataBytes.length));
        conn.setDoOutput(true);
        conn.getOutputStream().write(postDataBytes);

        Reader in = new BufferedReader(new InputStreamReader(conn.getInputStream(), "UTF-8"));

        for (int c; (c = in.read()) >= 0;)
            System.out.print((char)c);
        
    }		
	
}
