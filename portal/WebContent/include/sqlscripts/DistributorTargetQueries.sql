SELECT dtp.package_id, dtp.quantity, (select sum(quantity) from distributor_targets_packages_brands dtpb where dtpb.id = dtp.id and dtpb.package_id = dtp.package_id and brand_id in (select distinct brand_id from inventory_products where lrb_type_id = 1)) csd_total, (select sum(quantity) from distributor_targets_packages_brands dtpb where dtpb.id = dtp.id and dtpb.package_id = dtp.package_id and brand_id in (select distinct brand_id from inventory_products where lrb_type_id = 2)) water_total, (select sum(quantity) from distributor_targets_packages_brands dtpb where dtpb.id = dtp.id and dtpb.package_id = dtp.package_id and brand_id in (select distinct brand_id from inventory_products where lrb_type_id = 3)) energy_drink_total, (select sum(quantity) from distributor_targets_packages_brands dtpb where dtpb.id = dtp.id and dtpb.package_id = dtp.package_id and brand_id in (select distinct brand_id from inventory_products where lrb_type_id = 4)) juice_total, quantity-ifnull((select sum(quantity) from distributor_targets_packages_brands dtpb where dtpb.id = dtp.id and dtpb.package_id = dtp.package_id),0) any_total FROM pep.distributor_targets dt join distributor_targets_packages dtp on dt.id = dtp.id where month = 8 and year = 2016 and distributor_id = 100914;



SELECT dtp.package_id, (select label from inventory_packages where id = dtp.package_id), dtp.quantity, ifnull((select sum(quantity) from distributor_targets_packages_brands dtpb where dtpb.id = dtp.id and dtpb.package_id = dtp.package_id and brand_id in (select distinct brand_id from inventory_products where lrb_type_id = 2)), quantity-ifnull((select sum(quantity) from distributor_targets_packages_brands dtpb where dtpb.id = dtp.id and dtpb.package_id = dtp.package_id),0) ) target FROM pep.distributor_targets dt join distributor_targets_packages dtp on dt.id = dtp.id where month = 8 and year = 2016 and distributor_id = 100914;



SELECT dtp.package_id, dtp.quantity FROM pep.distributor_targets dt join distributor_targets_packages dtp on dt.id = dtp.id where month = 8 and year = 2016 and distributor_id = 100914;